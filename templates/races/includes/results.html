{% block results %}
{% load race_extras %}

{% with object.get_race_type_results as race_type_results %}
{% if race_type_results|length %}

	{% regroup object.get_overall_results by race_type as race_type_list %}
	{% for race_type in race_type_list %}
		<h3><a name="{{ race_type.grouper }}">{% if race_type.grouper %}{{ race_type.grouper }}{% endif %} Results</a></h3>

		<table border="1" cellpadding="10">
			<tr align="center">
				<th>Place</th>
				<th>Bib</th>
				<th>Name</th>
				<th>Gender</th>
				<th>Time</th>
				<th>Award</th>
				<th></th>
			</tr>
		  {% for result in race_type.list %}
				{% if result.course_record %}
				  {% ifequal result.racer.gender 1 %}
				    <tr bgcolor="CCFFFF">
				  {% else %}
				    <tr bgcolor="#FFCCCC">
				  {% endifequal %}
				{% else %}
				<tr>
				{% endif %}
					{% if result.dq or result.dns or result.dnf %}
						<td>&ndash;</td>
						<td>{{ result.bib_number }}</td>
						<td>{{ result.racer.full_name }}</td>
						<td>{{ result.racer.get_gender_display }}</td>
						{% if result.dq or result.dns or result.dnf %}
							{% if result.dq %}
								<td>DQ</td>
							{% else %}
								<td>{{ result.time }}</td>
							{% endif %}
						{% endif %}
						<td></td>
						<td></td>
					{% else %}
						<td>{{ forloop.counter }}</td>
						<td>{{ result.bib_number }}</td>
						<td><a href="{{ result.racer.get_absolute_url }}">{{ result.racer.full_name }}</a></td>
						<td>{{ result.racer.get_gender_display }}</td>
						<td>{{ result.time|replace_char:",:" }}</td>
						<td>{{ result.place }}</td>
						{% if result.course_record %}
							<td>CR</td>
						{% endif %}
					{% endif %}
				</tr>
			{% endfor %}
		</table>
	{% endfor %}
	</table>
{% endif %}
{% endwith %}

{% endblock %}
